<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f14" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Taxi Ledger</title>
  <link rel="manifest" href="./manifest.webmanifest" />

  <style>
    :root{
      --bg0:#070a0f; --bg1:#0b0f14;
      --card:rgba(255,255,255,.05);
      --card2:rgba(255,255,255,.04);
      --line:rgba(255,255,255,.10);
      --text:#eaf1ff;
      --muted:rgba(234,241,255,.65);
      --accent:#2a66ff;
      --good:#31d27c;
      --danger:#ff4d4d;

      --r:18px;
      --shadow: 0 18px 48px rgba(0,0,0,.45);
      --safeB: env(safe-area-inset-bottom, 0px);
      --safeT: env(safe-area-inset-top, 0px);
      --w: 980px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 900px at 20% -10%, rgba(42,102,255,.22), transparent 55%),
        radial-gradient(900px 700px at 110% 10%, rgba(49,210,124,.14), transparent 50%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      overflow-x:hidden;
    }

    .app{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      padding-bottom: calc(78px + var(--safeB));
    }

    .topbar{
      position:sticky;
      top:0;
      z-index:10;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(7,10,15,.92), rgba(7,10,15,.60));
      border-bottom: 1px solid rgba(255,255,255,.06);
      padding: calc(14px + var(--safeT)) 14px 12px;
    }

    .wrap{
      width:min(var(--w), 100%);
      margin:0 auto;
    }

    .headRow{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
    }

    .title{
      font-size: 26px;
      font-weight: 900;
      letter-spacing:.2px;
      line-height:1.05;
      margin:0;
    }
    .subtitle{
      margin:6px 0 0;
      color: var(--muted);
      font-weight:600;
      font-size: 13px;
    }

    .dateBox{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      box-shadow: 0 10px 28px rgba(0,0,0,.22);
      max-width: 220px;
    }
    .dateIcon{font-size:18px; opacity:.9}
    input[type="date"]{
      appearance:none;
      border:0;
      background:transparent;
      color:var(--text);
      font-weight:800;
      font-size:14px;
      width: 150px;
      outline:none;
    }

    .content{
      padding: 14px;
    }

    .card{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 14px;
      overflow:hidden;
    }

    .grid2{
      display:grid;
      gap:12px;
      grid-template-columns: 1fr 1fr;
    }

    .fieldWrap{
      display:flex;
      flex-direction:column;
      gap:6px;
      min-width:0;
    }

    label{
      color: var(--muted);
      font-size: 12px;
      font-weight: 800;
      letter-spacing:.2px;
    }

    .field{
      width:100%;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color: var(--text);
      padding: 14px 14px;
      font-size: 16px;
      font-weight: 800;
      outline:none;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
      min-width:0;
    }

    textarea.field{
      resize:none;
      min-height: 76px;
      font-weight:700;
    }

    .kpis{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    .kpi{
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 18px;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .kpi .k{color:var(--muted); font-weight:800; font-size:12px}
    .kpi .v{font-size:20px; font-weight:900; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}

    .hr{
      height:1px;
      background: rgba(255,255,255,.08);
      margin: 14px 0;
    }

    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
    }

    .btn{
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: var(--text);
      border-radius: 16px;
      padding: 12px 14px;
      font-weight: 900;
      font-size: 14px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .btn.primary{
      background: rgba(42,102,255,.18);
      border-color: rgba(42,102,255,.45);
    }
    .btn.danger{
      background: rgba(255,77,77,.12);
      border-color: rgba(255,77,77,.35);
    }
    .btn:active{transform: translateY(1px)}
    .btnWide{width:100%; justify-content:center}

    .muted{
      color: var(--muted);
      font-size: 12px;
      font-weight:700;
    }

    .expense-item{
      display:grid;
      grid-template-columns: 1fr 120px 46px;
      gap:10px;
      align-items:center;
      margin-bottom:10px;
    }
    .expense-item .btn{
      padding: 10px 10px;
      justify-content:center;
      border-radius: 14px;
    }

    .historyItem{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      border-radius: 18px;
      padding: 12px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      cursor:pointer;
    }
    .historyItem .d{font-weight:900}
    .historyItem .m{color:var(--muted); font-size:12px; margin-top:6px; line-height:1.35}
    .historyItem .n{font-weight:900; white-space:nowrap}

    .bottomTabs{
      position:fixed;
      left:0; right:0; bottom:0;
      padding: 10px 12px calc(12px + var(--safeB));
      background: linear-gradient(180deg, rgba(7,10,15,0), rgba(7,10,15,.75) 25%, rgba(7,10,15,.92));
      z-index:20;
    }
    .tabBar{
      width:min(var(--w), 100%);
      margin:0 auto;
      display:grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap:10px;
    }
    .tab{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      padding: 12px 10px;
      font-weight: 900;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      cursor:pointer;
      user-select:none;
    }
    .tab.active{
      background: rgba(42,102,255,.22);
      border-color: rgba(42,102,255,.55);
      box-shadow: 0 14px 40px rgba(42,102,255,.18);
    }

    .toast{
      position:fixed;
      left:50%;
      bottom: calc(92px + var(--safeB));
      transform: translateX(-50%);
      padding: 10px 14px;
      background: rgba(0,0,0,.55);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      font-weight: 900;
      font-size: 13px;
      color: var(--text);
      backdrop-filter: blur(10px);
      opacity:0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
      max-width: calc(100% - 28px);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-2px);}

    @media (max-width: 740px){
      .grid2{grid-template-columns: 1fr;}
      .expense-item{grid-template-columns: 1fr 120px 46px;}
      .title{font-size:24px}
      .dateBox{max-width: 190px}
      input[type="date"]{width: 130px}
    }
  </style>
</head>

<body>
  <div class="app">
    <div class="topbar">
      <div class="wrap">
        <div class="headRow">
          <div>
            <h1 class="title">Taxi Ledger</h1>
            <div class="subtitle">Î¤Î¶Î¯ÏÎ¿Ï‚ â€¢ ÎœÏ€Î¿Ï…ÏÎ¼Ï€Î¿Ï…Î¬Ï â€¢ Î†Î»Î»Î± â€¢ ÎˆÎ¾Î¿Î´Î±</div>
          </div>

          <div class="dateBox" title="Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±">
            <div class="dateIcon">ğŸ“…</div>
            <input id="dateInput" type="date" />
          </div>
        </div>
      </div>
    </div>

    <div class="content">
      <div class="wrap">
        <!-- ENTRY -->
        <div id="view-entry" class="card">
          <div class="grid2">
            <div class="fieldWrap">
              <label for="revenue">Î¤Î¶Î¯ÏÎ¿Ï‚ (â‚¬)</label>
              <input id="revenue" class="field" type="number" inputmode="decimal" step="0.01" placeholder="0" />
            </div>

            <div class="fieldWrap">
              <label for="tip1">ÎœÏ€Î¿Ï…ÏÎ¼Ï€Î¿Ï…Î¬Ï (â‚¬)</label>
              <input id="tip1" class="field" type="number" inputmode="decimal" step="0.01" placeholder="0" />
            </div>

            <div class="fieldWrap">
              <label for="tip2">Î†Î»Î»Î± (â‚¬)</label>
              <input id="tip2" class="field" type="number" inputmode="decimal" step="0.01" placeholder="0" />
            </div>

            <div class="fieldWrap">
              <label for="expensesTotal">Î£ÏÎ½Î¿Î»Î¿ ÎµÎ¾ÏŒÎ´Ï‰Î½ (â‚¬)</label>
              <input id="expensesTotal" class="field" type="text" readonly value="0.00" />
            </div>
          </div>

          <div class="hr"></div>

          <button id="addExpenseBtn" class="btn btnWide">â• Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎµÎ¾ÏŒÎ´Î¿Ï…</button>
          <div style="height:10px"></div>
          <div id="expensesList"></div>

          <div class="hr"></div>

          <div class="fieldWrap">
            <label for="note">Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</label>
            <textarea id="note" class="field" placeholder="Ï€.Ï‡. ÎºÎ±ÏÏƒÎ¹Î¼Î±, Î²ÏÎ¿Ï‡Î®, Î±ÎµÏÎ¿Î´ÏÏŒÎ¼Î¹Î¿â€¦"></textarea>
          </div>

          <div class="kpis">
            <div class="kpi">
              <div class="k">Î¤Î¶Î¯ÏÎ¿Ï‚</div>
              <div id="kpiRevenue" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">ÎœÏ€Î¿Ï…ÏÎ¼Ï€Î¿Ï…Î¬Ï + Î†Î»Î»Î±</div>
              <div id="kpiExtras" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">ÎŒÎ»Î± Î¼Î±Î¶Î¯ (Î¤Î¶Î¯ÏÎ¿Ï‚ + extra)</div>
              <div id="kpiTotal" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">ÎšÎ±Î¸Î±ÏÏŒ Î¼ÎµÏ„Î¬ Ï„Î± Î­Î¾Î¿Î´Î±</div>
              <div id="kpiNet" class="v">0,00 â‚¬</div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="btnRow">
            <div class="muted" id="autosaveState">Auto-save: Î­Ï„Î¿Î¹Î¼Î¿</div>
            <button id="saveBtn" class="btn primary">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)</button>
          </div>

          <div class="hr"></div>

          <div class="fieldWrap">
            <label>Google Drive Sync (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ backup)</label>
            <div class="muted" id="syncState">â€”</div>
            <div style="height:10px"></div>
            <div class="btnRow">
              <label class="btn" style="gap:12px;">
                <input id="syncToggle" type="checkbox" style="width:18px;height:18px;">
                Auto-sync (ÏŒÏ„Î±Î½ ÎµÎ¯ÏƒÎ±Î¹ Î®Î´Î· ÏƒÏ…Î½Î´ÎµÎ´ÎµÎ¼Î­Î½Î¿Ï‚)
              </label>
              <button id="syncLoginBtn" class="btn">ğŸ” Î£ÏÎ½Î´ÎµÏƒÎ· Google</button>
              <button id="syncNowBtn" class="btn">â« Sync Ï„ÏÏÎ±</button>
              <button id="restoreBtn" class="btn">â¬ Restore</button>
            </div>
            <div style="height:10px"></div>
            <div class="muted">
              Î£Î·Î¼ÎµÎ¯Ï‰ÏƒÎ·: Î‘Î½ ÎºÎ¬Î½ÎµÎ¹Ï‚ â€œClear site data/cookiesâ€ Î¿ browser ÏƒÎ²Î®Î½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿Ï€Î¹ÎºÎ¬ Î´ÎµÎ´Î¿Î¼Î­Î½Î±.
              ÎœÎµ Drive ÎºÎ¬Î½ÎµÎ¹Ï‚ Restore.
            </div>
          </div>
        </div>

        <!-- HISTORY -->
        <div id="view-history" class="card" style="display:none">
          <div class="muted" style="margin-bottom:10px">Î Î¬Ï„Î± Î¼Î¹Î± Î¼Î­ÏÎ± Î³Î¹Î± Î½Î± Ï„Î· Ï†Î¿ÏÏ„ÏÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ ÎºÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·.</div>
          <div id="historyList"></div>
        </div>

        <!-- SUMMARY -->
        <div id="view-summary" class="card" style="display:none">
          <div class="kpis" style="grid-template-columns: 1fr;">
            <div class="kpi">
              <div class="k">Î—Î¼Î­ÏÎµÏ‚</div>
              <div id="sumDays" class="v">0</div>
            </div>
            <div class="kpi">
              <div class="k">Î£ÏÎ½Î¿Î»Î¿ Î¤Î¶Î¯ÏÎ¿Ï…</div>
              <div id="sumRevenue" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">Î£ÏÎ½Î¿Î»Î¿ ÎœÏ€Î¿Ï…ÏÎ¼Ï€Î¿Ï…Î¬Ï</div>
              <div id="sumTip1" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">Î£ÏÎ½Î¿Î»Î¿ Î†Î»Î»Î±</div>
              <div id="sumTip2" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">Î£ÏÎ½Î¿Î»Î¿ Î•Î¾ÏŒÎ´Ï‰Î½</div>
              <div id="sumExpenses" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">ÎŒÎ»Î± Î¼Î±Î¶Î¯ (Î¤Î¶Î¯ÏÎ¿Ï‚ + extra)</div>
              <div id="sumAllIn" class="v">0,00 â‚¬</div>
            </div>
            <div class="kpi">
              <div class="k">ÎšÎ±Î¸Î±ÏÏŒ Î¼ÎµÏ„Î¬ Ï„Î± Î­Î¾Î¿Î´Î±</div>
              <div id="sumNet" class="v">0,00 â‚¬</div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <div class="bottomTabs">
      <div class="tabBar">
        <div class="tab active" data-tab="entry">â• ÎšÎ±Ï„Î±Ï‡ÏÏÎ·ÏƒÎ·</div>
        <div class="tab" data-tab="history">ğŸ“š Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ</div>
        <div class="tab" data-tab="summary">ğŸ“Š Î£ÏÎ½Î¿Î»Î±</div>
      </div>
    </div>

    <div id="toast" class="toast">OK</div>
  </div>

  <script src="./db.js"></script>
  <script src="./driveSync.js"></script>
  <script src="./app.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
</body>
</html>